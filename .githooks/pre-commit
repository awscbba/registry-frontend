#!/bin/bash

# Pre-commit hook for registry-frontend
# Runs linting checks before allowing commits

set -e

echo "ğŸ” Running pre-commit validation..."

# Get list of staged TypeScript/JavaScript files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx)$' || true)

if [ -z "$STAGED_FILES" ]; then
    echo "âœ… No TypeScript/JavaScript files to check"
    exit 0
fi

echo "ğŸ” Running ESLint on staged files..."
for FILE in $STAGED_FILES; do
    if [ -f "$FILE" ]; then
        npx eslint "$FILE" 2>/dev/null || {
            echo "âš ï¸  ESLint warnings/errors in $FILE (not blocking commit)"
        }
    fi
done

echo "âœ… Pre-commit validation passed!"
echo "ğŸ“Š Completed checks:"
echo "   âœ… Code linting (eslint)"
echo ""
echo "ğŸ’¡ Tip: Run 'npm run format' to format all files with Prettier"

exit 0
